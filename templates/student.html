{% extends "base.html" %}

{% block title %}
    الطلاب
{% endblock %}

{% block body %}
<!-- Page Content  -->

<div>
  <div class="student">
    <div class="pt-4 pb-3 form-title">
      <h2 class="text-center">الطلاب</h2>
    </div>

    <div class="s009 mb-3">
      <form action="{{ url_for('search') }}" method="POST">
        <div class="inner-form">
          <div class="basic-search">
            <div class="input-field">
              <input id="search" type="text" {% if search_val %}value="{{ search_val }}"{% endif%} name="search_data" autofocus placeholder="بحث .." />
              <!-- <input type="text" name="" value=""> -->
              <div class="icon-wrap">
                <button type="submit" class="btn btn-light" id="search_btn">
                <svg class="svg-inline--fa fa-search fa-w-16" fill="#ccc" aria-hidden="true" data-prefix="fas" data-icon="search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path>
                </svg>
                </button>
                <!-- <input type="submit" id="search_btn" name="search" value="search"> -->
              </div>
              <div class="icon-fiter p-3">
                <div id="filter_button">
                  <i class="fas fa-filter fa-sm"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="advance-search" id="filter_form">
            <span class="desc text-right">بحث متقدم</span>
            <div class="row">
              <div class="col-md-6 form-inline">
                <div class="input-select">
                  <!-- <label for="selectboxnum1"></label> -->
                  <select data-trigger="" class="custom-select my-1 mr-sm-2" id="selectboxnum1" name="major_filter">
                    <option placeholder="الشعبة" value="0">الشعبه</option>
                    {% for row in majors  %}
                    <option value="{{ row.id }}">{{ row.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="col-md-6 form-inline">
                <div class="input-select">
                  <select data-trigger="" class="custom-select my-1 mr-sm-2" name="level_filter">
                    <option placeholder="" value="">الفرقة</option>
                    {% for row in levels %}
                    <option value="{{ row.id }}">{{ row.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>

            </div>

          </div>
        </div>
      </form>
    </div>


    <div class="row" style="position:relative; height:1em">
      {% if session["is_super_user"] and session["is_admin"]  %}
      <div class="control-btn mr-4">
        <form action="{{ url_for('delete_all') }}" method="POST">
          <button class="btn btn-danger btn-sm" title="Delete All" onclick="return confirm('Are you sure to Delete All Students?')" type="submit" style="cursor: pointer;" name="delete_all"><i class="fas fa-trash-alt" ></i></button>
        </form>
        <form action="{{ url_for('generate_svg') }}" method="post" style="margin-left:5px">
          <button class="btn btn-info btn-sm" title="Generate SVG Image" type="submit" style="cursor: pointer;" name="generate"><i class="fas fa-barcode" ></i></button>
        </form>
      </div>
      {% endif %}
      <div class="paginate-data ml-4 mb-2 ">
        <p>عرض <span class="text-info">{{ rows.per_page }}</span> من اجمالي <span class="text-success">{{ rows.total }}</span></p>
      </div>

    </div>
    <div class="display-barcode mt-4">

      <div class="list-view" id="list">


        <table class="table text-right bg-white" id="student_table" style="direction:rtl;">
          <thead>
            <tr>
              <th scope="col"><input type="checkbox" onClick="toggle(this)" style="height:1em;width: 1em;" name="selectall" value="0"></th>
              <th scope="col">#</th>
              <th scope="col">الكود</th>
              <th scope="col">الاسم</th>
              <th scope="col">القسم</th>
              <th scope="col">الفرقة</th>
              <th scope="col">الباركود</th>
              <th scope="col">الملفات</th>
            </tr>
          </thead>
          <tbody>

            {% for row in rows.items %}

            <tr>
              <td><input type="checkbox" name="student" value="{{ row.id }}" style="height: .9em;width: .9em;"></td>
              <th scope="row">{{ loop.index }}</th>
              <td>{{ row.un_id }}</td>
              <td><a href="{{ url_for('student', id=row.id) }}">{{ row.name }}</a></td>
              <td>{{ row.major.name }}</td>
              <td>{{ row.level.name }}</td>
              {% if row.image %}
              <td>
                <i class="fa fa-check"></i>
              </td>
              {% else %}
              <td><i class="fas fa-times"></i></td>
              {% endif %}
              <td>

                <a href="{{ url_for('generate_word_file', id=row.id) }}" class="btn btn-light text-info btn-sm" download title="Generate Word File for student data." type="submit" style="cursor: pointer;" name="delete_all"><i class="fas fa-file-word"></i></a>
                <a href="{{ url_for('generate_word_file', id=row.id) }}" class="btn btn-light text-danger btn-sm" title="Generate PDF File for student data." type="submit" style="cursor: pointer;" name="delete_all"><i class="fas fa-file-pdf"></i></a>
                {% if  row.image %}
                <a href="{{ url_for('download_barcode', id=row.id) }}"class="btn btn-light text-success btn-sm" download><span><i class="fas fa-image"></i></span></a>
                {%endif%}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="card" id="card">
        <div class="row">
          {% for row in students %}
          <div class="col-md-2">
            <div class="card p-1" for="check_{{ row.un_id }}" style="width: 11rem;position:relative;">

              <input type="checkbox" name="student_card_v" id="check_{{ row.un_id }}" value="{{ row.id }}" style="position:absolute; right:1px"/>
              {% if row.barcode_path %}
              <img src="{{ url_for('static', filename=row.barcode_path) }}" alt="{{ row.name }}" class="card-img-top"  title="{{ row.un_id }}-{{ row.name }}">
              {% else %}

              {% endif %}
              <div class="card-body">
                <p class="card-text">{{ row.major_id }} - {{ row.level_id }}</p>
                <a href="#" class="btn btn-outline-primary btn-sm">Print</a>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

      </div>

    </div>
    <div class="paginate-links">
      <nav aria-label="Page text-center navigation example">
        <ul class="pagination justify-content-center">
          <li class="page-item">
            <a class="page-link" href="{{ url_for('all_student', page=rows.prev_num) }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
        {% for page_num in rows.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
          {% if page_num %}
            {% if rows.page == page_num %}
                <li class="page-item active"><a class="page-link" href="{{ url_for('all_student', page=page_num) }}">{{ page_num }}</a></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="{{ url_for('all_student', page=page_num) }}">{{ page_num }}</a></li>
              {% endif %}
          {% else %}
            ...
          {% endif %}
        {% endfor %}
          <li class="page-item">
            <a class="page-link" href="{{ url_for('all_student', page=rows.next_num) }}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>


{% endblock%}
